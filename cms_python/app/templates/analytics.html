{% extends "base.html" %}
{% from 'components/sidebar_card.html' import card with context %}

{% block title %}åˆ†æãƒ¬ãƒãƒ¼ãƒˆ{% endblock %}

{% block head %}
    {{ super() }}
    <link rel="stylesheet" href="{{ url_for('static', path='css/analytics.css') }}" type="text/css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}

{% block sidebar %}
<aside class="layout-sidebar">
    {% call card('ãƒ¬ãƒãƒ¼ãƒˆç¨®åˆ¥', icon='ğŸ“Š') %}
    <nav class="report-nav">
        <a href="#" class="report-link active" data-report="engagement">æŠ•è³‡å®¶ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆ</a>
        <a href="#" class="report-link" data-report="faq">FAQåˆ†æ</a>
        <a href="#" class="report-link" data-report="dialogue">å¯¾è©±ãƒˆãƒ¬ãƒ³ãƒ‰</a>
        <a href="#" class="report-link" data-report="performance">æ‹…å½“è€…ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</a>
    </nav>
    {% endcall %}

    {% call card('æœŸé–“ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼', icon='ğŸ“…') %}
    <div class="filter-group">
        <select class="form-control">
            <option>éå»7æ—¥é–“</option>
            <option selected>éå»30æ—¥é–“</option>
            <option>éå»90æ—¥é–“</option>
            <option>å…¨æœŸé–“</option>
        </select>
        <button class="btn-secondary" style="margin-top: 0.5rem;">ã‚«ã‚¹ã‚¿ãƒ æœŸé–“</button>
    </div>
    {% endcall %}
</aside>
{% endblock %}

{% block content %}
<main class="layout-content">
    <div class="page-header">
        <h1 class="page-title">ğŸ“Š åˆ†æãƒ¬ãƒãƒ¼ãƒˆ</h1>
        <div class="header-actions">
            <button class="btn-primary">ãƒ¬ãƒãƒ¼ãƒˆã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
        </div>
    </div>

    <!-- ä¸»è¦KPI -->
    <!--
    <div class="kpi-grid">
        {% for key, kpi in kpi_data.items() %}
            {% include 'components/kpi_card.html' with {'icon': kpi.icon, 'label': kpi.label, 'value': kpi.value, 'change': kpi.change, 'positive': kpi.positive} %}
        {% endfor %}
    </div>
    -->

    <!-- ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆæ¨ç§» -->
    <div class="chart-container card">
        <h3 class="card-header">ğŸ“ˆ ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆæ¨ç§»</h3>
        <div class="card-body">
            <canvas id="engagementChart"></canvas>
        </div>
    </div>

    <!-- è³ªå•ã‚«ãƒ†ã‚´ãƒªåˆ†æ -->
    <div class="grid-container">
        <div class="chart-container card">
            <h3 class="card-header">â“ è³ªå•ã‚«ãƒ†ã‚´ãƒª</h3>
            <div class="card-body">
                <canvas id="categoryChart"></canvas>
            </div>
        </div>
        <div class="card">
            <h3 class="card-header">ğŸ† ãƒˆãƒƒãƒ—ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ¼</h3>
            <div class="card-body">
                <ul class="performer-list">
                    <li><strong>æ‰æ‘:</strong> è§£æ±ºæ•° 58, æº€è¶³åº¦ 98%</li>
                    <li><strong>ç”°ä¸­:</strong> è§£æ±ºæ•° 45, æº€è¶³åº¦ 95%</li>
                    <li><strong>éˆ´æœ¨:</strong> è§£æ±ºæ•° 32, æº€è¶³åº¦ 93%</li>
                </ul>
            </div>
        </div>
    </div>

</main>
{% endblock %}

{% block extra_js %}
<script>
    // ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆæ¨ç§»ãƒãƒ£ãƒ¼ãƒˆ
    const engagementCtx = document.getElementById('engagementChart').getContext('2d');
    new Chart(engagementCtx, {
        type: 'line',
        data: {
            labels: ['1é€±å‰', '6æ—¥å‰', '5æ—¥å‰', '4æ—¥å‰', '3æ—¥å‰', '2æ—¥å‰', 'æ˜¨æ—¥'],
            datasets: [{
                label: 'ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆæ•°',
                data: [120, 150, 130, 180, 160, 200, 210],
                borderColor: 'var(--primary-color)',
                backgroundColor: 'rgba(54, 162, 235, 0.2)',
                tension: 0.3,
                fill: true,
            }]
        }
    });

    // è³ªå•ã‚«ãƒ†ã‚´ãƒªãƒãƒ£ãƒ¼ãƒˆ
    const categoryCtx = document.getElementById('categoryChart').getContext('2d');
    new Chart(categoryCtx, {
        type: 'doughnut',
        data: {
            labels: ['äº‹æ¥­æˆ¦ç•¥', 'è²¡å‹™çŠ¶æ³', 'è£½å“ãƒ»ã‚µãƒ¼ãƒ“ã‚¹', 'ã‚µã‚¹ãƒ†ãƒŠãƒ“ãƒªãƒ†ã‚£', 'ãã®ä»–'],
            datasets: [{
                label: 'è³ªå•ã‚«ãƒ†ã‚´ãƒª',
                data: [35, 25, 20, 15, 5],
                backgroundColor: [
                    '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF'
                ]
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
        }
    });
</script>
{% endblock %} 